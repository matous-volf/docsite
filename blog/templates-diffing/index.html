<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Dioxus | An elegant GUI library for Rust</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />

    <meta name="description" content="An elegant GUI library for Rust, inspired by React. Supports Web, Desktop, SSR, Liveview, and Mobile.">

    <link rel="icon shortcut" type="image/png" href="/./static/favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arimo:wght@100;400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&family=Lexend:wght@100;400&family=M+PLUS+1:wght@100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="/./static/prism/prism.css" />


    <!-- Social meta stuff -->
    <!-- open graph -->
    <meta
      property="og:title"
      content="Dioxus - Reliable Rust apps that run anywhere"
    />

    <meta property="og:type" content="website" />

    <meta
      property="og:description"
      content="An elegant GUI library for Rust, inspired by React. Supports Web, Desktop, SSR, Liveview, and Mobile."
    />

    <meta property="og:url" content="https://dioxuslabs.com/" />

    <meta
      property="og:image"
      content="https://dioxuslabs.com/static/opengraph.png"
    />

    <!-- twitter -->
    <meta
      name="twitter:title"
      content="Dioxus - Reliable Rust apps that run anywhere"
    />
    <meta
      name="twitter:description"
      content="An elegant GUI library for Rust, inspired by React. Supports Web, Desktop, SSR, Liveview, and Mobile."
    />
    <meta
      name="twitter:image"
      content="https://dioxuslabs.com/static/opengraph.png"
    />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EBE72MVZ1B"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-EBE72MVZ1B');
    </script>

    <!-- style stuff -->
    <!-- <link data-trunk rel="css" href="/tailwind.css" /> -->
    <!-- <link rel="stylesheet" href="/./tailwind.css" />
    <link rel="stylesheet" href="/./main.css" />
    <link rel="stylesheet" href="/./githubmarkdown.css" /> -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
    <script src="/./static/darktheme.js"></script>
    <link rel="stylesheet" href="/dxpcss706ce0b3ef3042c6.css">

  </head>

  <body>
    <div id="main"><div class="bg-white dark:bg-ideblack pb-8" data-node-hydration="0"><link rel="stylesheet" href="/githubmarkdown.css"/><link rel="stylesheet" href="/tailwind.css"/><link rel="stylesheet" href="/main.css"/><div class="fixed top-0 left-0 z-50 block bg-gray-500 bg-opacity-50 overflow-y-hidden search-modal-animated dioxus-hide" style="height:100vh;width:100vw;" data-node-hydration="1,click:1"><div class="max-w-screen-md mx-auto h-full flex flex-col"><div class="h-30"></div><div class="bg-white dark:bg-ideblack p-2 md:p-6 rounded-2xl m-2 md:m-8 max-h-[calc(100%-8rem)] overflow-y-auto text-gray-800 dark:text-gray-100"><div class="flex flex-row flex-grow border-b border-gray-300 pb-4"><div class="my-auto flex flex-row"><span class="material-icons material-icons-outlined material-icons-round material-icons-sharp material-icons-two-tone md-48" style="font-size: 40px; color: rgba(0, 0, 0, 0.54); user-select: none;" data-node-hydration="2"><!--node-id3-->search<!--#--></span><pre data-node-hydration=4></pre></div></div><div class="overflow-y-auto"><ul><div class="text-center text-xlg p-4" data-node-hydration="5">No results found<div class="dark:text-white text-left text-lg p-4"><div>Try searching for:<ul><li data-node-hydration="6"><button class="underline p-1 md:p-2" data-node-hydration="7,click:1"><!--node-id8-->Fullstack<!--#--></button></li><li data-node-hydration="9"><button class="underline p-1 md:p-2" data-node-hydration="10,click:1"><!--node-id11-->Typesafe Routing<!--#--></button></li><li data-node-hydration="12"><button class="underline p-1 md:p-2" data-node-hydration="13,click:1"><!--node-id14-->Authentication<!--#--></button></li></ul></div><div class="mt-4">Or go to:<ul><li class="p-1 md:p-2" data-node-hydration="15"><a href="/learn/0.5/" dioxus-prevent-default="onclick" class="underline " data-node-hydration="16,click:1"><!--node-id17-->Learn<!--#--></a></li><li class="p-1 md:p-2" data-node-hydration="18"><a href="/blog" dioxus-prevent-default="onclick" class="underline " data-node-hydration="19,click:1"><!--node-id20-->Blog<!--#--></a></li><li class="p-1 md:p-2" data-node-hydration="21"><a href="/awesome" dioxus-prevent-default="onclick" class="underline " data-node-hydration="22,click:1"><!--node-id23-->Awesome<!--#--></a></li><li class="p-1 md:p-2" data-node-hydration="24"><a href="https://docs.rs/dioxus/latest/dioxus/" dioxus-prevent-default="" class="underline " rel="noopener noreferrer" data-node-hydration="25,click:1"><!--node-id26-->docs.rs<!--#--></a></li></ul></div></div></div></ul></div></div></div></div><header class="sticky top-0 z-30 bg-white bg-opacity-80 dark:text-gray-200 dark:bg-ideblack dark:bg-opacity-80 border-b dark:border-stone-700 h-16 backdrop-blur-sm" data-node-hydration="27"><div class="lg:py-2 px-2 max-w-screen-2xl mx-auto flex items-center justify-between text-sm leading-6 h-16"><button class="bg-zinc-300 rounded-lg p-2 mr-4 lg:hidden my-3 h-10 flex items-center text-lg z-[100] hidden" data-node-hydration="28,click:1"><span class="material-icons material-icons-outlined material-icons-round material-icons-sharp material-icons-two-tone md-48" style="font-size: 24px; color: rgba(0, 0, 0, 0.54); user-select: none;" data-node-hydration="29"><!--node-id30-->menu<!--#--></span></button><div class="flex z-50 md:flex-1 px-2"><nav class="flex items-center space-x-2 text-md font-light leading-none text-slate-700 dark:text-white whitespace-nowrap" data-node-hydration="31"><a href="/" dioxus-prevent-default="onclick" class="flex title-font font-medium items-center text-gray-900" data-node-hydration="32,click:1"><img src="https://avatars.githubusercontent.com/u/79236386?s=200&v=4" class="h-8 w-auto" data-node-hydration="33"/><span class="mx-3 text-xl dark:text-white leading-none font-bold hidden sm:block px-4" data-node-hydration="34">Dioxus Labs</span></a><a href="/learn/0.5/" dioxus-prevent-default="onclick" class="p-0 p-2 leading-none hover:text-sky-500 dark:hover:text-sky-400 rounded fill-zinc-700 dark:fill-zinc-100 " style="position:relative;" data-node-hydration="35,click:1"><!--node-id36-->Learn<!--#--><pre data-node-hydration=37></pre></a><a href="/blog" dioxus-prevent-default="onclick" class="p-0 p-2 leading-none hover:text-sky-500 dark:hover:text-sky-400 rounded fill-zinc-700 dark:fill-zinc-100 text-sky-500 dark:text-sky-400" style="position:relative;" data-node-hydration="38,click:1"><!--node-id39-->Blog<!--#--><pre data-node-hydration=40></pre></a><a href="/awesome" dioxus-prevent-default="onclick" class="p-0 p-2 leading-none hover:text-sky-500 dark:hover:text-sky-400 rounded fill-zinc-700 dark:fill-zinc-100 " style="position:relative;" data-node-hydration="41,click:1"><!--node-id42-->Awesome<!--#--><pre data-node-hydration=43></pre></a><a href="https://docs.rs/dioxus/latest/dioxus/" dioxus-prevent-default="" class="p-0 p-2 leading-none hover:text-sky-500 dark:hover:text-sky-400 rounded fill-zinc-700 dark:fill-zinc-100 " rel="noopener noreferrer" style="position:relative;" data-node-hydration="44,click:1"><!--node-id45-->docs.rs<!--#--><svg height="7" viewBox="0 0 6 6" width="7" aria-hidden="true" class="navbar_externalArrow___VWBd" data-node-hydration="46"><path d="M1.25215 5.54731L0.622742 4.9179L3.78169 1.75597H1.3834L1.38936 0.890915H5.27615V4.78069H4.40513L4.41109 2.38538L1.25215 5.54731Z"></path></svg></a></nav></div><div class="hidden md:flex h-full justify-end ml-2 flex-1"><div class="hidden md:flex items-center"><div class="relative md:w-full max-w-[20rem] xl:max-w-[20rem] 2xl:max-w-[20rem] sm:mx-auto sm:flex-1" data-node-hydration="47"><button class="bg-gray-100 rounded-lg p-2 sm:w-full text-left text-gray-400 my-auto sm:flex sm:flex-row sm:align-middle sm:justify-between" data-node-hydration="48,click:1"><div class="h-full my-auto flex flex-row align-middle justify-between"><span class="material-icons material-icons-outlined material-icons-round material-icons-sharp material-icons-two-tone md-48" style="font-size: 24px; color: rgba(0, 0, 0, 0.54); user-select: none;" data-node-hydration="49"><!--node-id50-->search<!--#--></span><span class="hidden sm:block pl-2 pr-4">Search the docs</span></div><div class="hidden md:block border border-gray-300 rounded-lg p-1 text-xs text-gray-400">CTRL + /</div></button></div><div class="hidden lg:flex items-center border-l border-gray-200 ml-4 pl-4 dark:border-gray-800"><label class="sr-only" id="headlessui-listbox-label-2">Theme</label><a href="https://discord.gg/XgGxMSkvUM" dioxus-prevent-default="" class="block text-gray-400 hover:text-gray-500 dark:hover:text-gray-300" rel="noopener noreferrer" target="_blank" data-node-hydration="51,click:1"><span class="sr-only" data-node-hydration="52">Dioxus on Discord</span><svg width="24" height="24" viewBox="0 -28.5 256 256" preserveAspectRatio="xMidYMid" data-node-hydration="53"><g><path d="M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z" fill="currentColor" fill-rule="nonzero"></path></g></svg></a><a href="https://github.com/dioxuslabs/dioxus" dioxus-prevent-default="" class="ml-4 block text-gray-400 hover:text-gray-500 dark:hover:text-gray-300" rel="noopener noreferrer" target="_blank" data-node-hydration="54,click:1"><span class="sr-only" data-node-hydration="55">Dioxus on GitHub</span><svg class="w-5 h-5" viewBox="0 0 16 16" aria-hidden="true" fill="currentColor" data-node-hydration="56"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div><div class="hidden lg:flex items-center border-l border-gray-200 ml-4 pl-6 dark:border-gray-800"><label class="sr-only" id="headlessui-listbox-label-2">Theme</label><a href="/deploy" dioxus-prevent-default="onclick" class="md:ml-0 md:py-2 md:px-3 bg-blue-500 ml-4 text-lg md:text-sm text-white rounded font-semibold" data-node-hydration="57,click:1"><!--node-id58-->DEPLOY<!--#--></a><pre data-node-hydration=59></pre></div></div></div></div></header><section class="text-gray-600 body-font dark:bg-ideblack max-w-screen-md mx-auto pt-24 font-light" data-node-hydration="60"><script>Prism.highlightAll()</script><article class="markdown-body px-2  dioxus-blog-post" data-node-hydration="61"><h1 id="making-dioxus-almost-as-fast-as-solidjs">Making Dioxus (almost) as fast as SolidJS</h1>
<p><a href="https://github.com/dioxuslabs/dioxus">Dioxus</a> is a UI library for Rust that makes it easy to target almost any platform with the same React-like codebase. You can build apps for WASM, desktop, mobile, TUI, static-sites, SSR, LiveView, and more.</p>
<hr>
<p>In preparation for the next big release of Dioxus, one of the lead contributors, ealmloff, added a long-awaited feature: <strong>subtree memoization</strong>.</p>
<p>Subtree memoization reduces the overall work that Dioxus needs to do to get your desired UI state to the screen by several orders of magnitude. In fact, it’s so fast, that it pushes Dioxus to the leading edge of performance for web frameworks, on par with the likes of SolidJS, even beating out signal-based Rust libraries like Sycamore 0.8 and Leptos 0.0.3.</p>
<p><img src="https://i.imgur.com/9rbAXP9.png"></p>
<p>There’s obviously still some room to grow as WASM-based UI libraries face unique challenges compared to their JavaScript counterparts. Ultimately, we hope that this update demonstrates what’s really possible with the current React paradigm.</p>
<p>And, of course, we need to mention that benchmarks never give a truly clear insight into how performant a library is, especially as an app scales. It’s definitely reasonable to believe that as an app grows in size, any other library might come out ahead. You shouldn’t make a decision on the framework for your next project just because it’s slightly more or less performant than any other library based on entirely arbitrary benchmarks.</p>
<p><img src="https://i.imgur.com/Mfu8QOX.png"></p>
<p>Anyways…</p>
<h2 id="dioxus-shares-react-s-dna">Dioxus shares React’s DNA</h2>

<p>As eloquently put by the creator of Svelte, the <a href="https://svelte.dev/blog/virtual-dom-is-pure-overhead">“Virtual DOM is pure overhead”</a>. So, why does Dioxus continue to share the React DNA if it’s ultimately just frivolous work?</p>
<p>Well, we still love React, despite its warts, footguns, and idiosyncrasies.</p>
<ul>
<li>React is just JavaScript, no magic compilation needed.</li>
<li>Components are just tiny event loops with mostly predictable re-renders.</li>
<li>React’s paradigm maps extremely well into Rust.</li>
</ul>
<p>The final point is arguably the most important: React’s functional model maps well into Rust’s lifetime system. Any value provided to the component through <code>use_hook</code> is bounded by the lifetime of the <code>Scope</code> itself. <code>Scope</code> can be shared into any handler - like <code>onclick</code> in the following example. Since <code>value</code> shares a lifetime with <code>Scope</code>, it can be modified directly within element callbacks.</p>
<pre><code class="lang-rust">fn app(cx: <span class="hljs-keyword">Scope</span>) -&gt; Element {
    <span class="hljs-keyword">let</span> value: &amp;mut u32 = cx.use_hook(|<span class="hljs-type">| 0</span>);

    cx.render(rsx!(
        button { onclick: <span class="hljs-built_in">move</span> |<span class="hljs-type">_</span>| <span class="hljs-type">value</span> += <span class="hljs-number">1</span>, <span class="hljs-string">"Increment"</span> }
    ))
}
</code></pre>
<p>This clean mapping of React’s paradigms into Rust makes it possible for Dioxus to achieve excellent developer experience.</p>
<ul>
<li>Components are just regular functions.</li>
<li>The foundational <code>use_hook</code> provides a direct mutable reference to a value.</li>
<li>Values created with the Scope’s lifetime can be passed directly into children, unlike nearly all non-signal-based libraries.</li>
</ul>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> doc = use_document_builder(cx);

rsx! {
    Doc { document: doc }
}

<span class="hljs-meta">#[component]</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">Doc</span></span>&lt;<span class="hljs-symbol">'a</span>&gt;(cx: Scope&lt;<span class="hljs-symbol">'a</span>&gt;, document: &amp;<span class="hljs-symbol">'a</span> SomeBigDocument) -&gt; Element {
    <span class="hljs-comment">// document is passed from a parent by reference!</span>
    <span class="hljs-comment">// no smart pointers required!</span>
}
</code></pre>
<p>All in all, we’ve learned to love lifetimes rather than fear them. But for all the good of React, we’re still stuck with the bad.</p>
<h2 id="overcoming-the-warts-of-react">Overcoming the warts of React</h2>

<p>One of the biggest issues React has is the need to recreate entire chunks of the virtual DOM between renders. If you’re not aware, in React, your JSX markup is converted directly to <code>React.createElement</code> calls.</p>
<pre><code class="lang-jsx"><span class="hljs-comment">// This markup</span>
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">abc</span>"&gt; <span class="hljs-title">Hello</span> <span class="hljs-title">world</span> &lt;<span class="hljs-type">/div</span>&gt;</span>

<span class="hljs-comment">// becomes these calls</span>
React.createElement(div, { <span class="hljs-class"><span class="hljs-keyword">class</span>: <span class="hljs-type">"abc" }</span>, <span class="hljs-type">[React.createText</span></span>(<span class="hljs-string">"hello world"</span>)]);
</code></pre>
<p>This means for every new element in your tree, the transpiled JS is allocating several objects, arrays, and complex structures between <em>every</em> render. There’s no wonder why React isn’t on the top of the performance charts! In Rust, it’s generally not best practice to generate so many heap-allocated objects.</p>
<p>Heck, there was even a very popular reddit post talking about this problem.</p>
<p><a href="https://www.reddit.com/r/rust/comments/yd9ngs/worried_about_modern_rust_gui_libraries/">“Worried about “modern” Rust GUI libraries”</a></p>
<p>In Dioxus, we noticed this early on and decided to see if we could reuse all the heap allocations instead of just tossing them out. Inspired by the work on Dodrio, Dioxus is implemented using a bump allocator and double-buffering, just like many high-performance GPU APIs.</p>
<p>When you create a div, or a piece of text, or anything in Dioxus, it simply gets allocated inside a bump arena that gets reset when diffed. No cleanup, no extra heap allocations, just steady-state reuse of pre-allocated memory.</p>
<p><img src="https://i.imgur.com/PYtTb6I.png"></p>
<p>This is fast. Really fast. And when coupled with automatic component memoization, it’s really easy to write Dioxus apps that are memory efficient and faster than React.</p>
<p>Great, case-closed, that’s it, right?</p>
<p>Well, no. Dioxus still wasn’t nearly as fast as Svelte, Sycamore, SolidJS, or even InfernoJS. We’ve optimized a bunch of tiny things, like string caching, batched DOM manipulations, faster PartialEq, diffing, and pretty much everything you could think of.</p>
<p>Except, we’re creating new objects, still in the heap, and doing a lot of diffing work. In the words of the creator of Svelte,</p>
<blockquote>
<p>But you know what would be even faster? <em>Not doing that.</em></p>
</blockquote>
<h2 id="making-dioxus-faster-by-doing-less-work">Making Dioxus faster by doing less work</h2>

<p>To really make Dioxus faster, we need to make it do less work - or, at the very least, less work at runtime. SolidJS does this by thrusting you into this world of signals. We love signals! They might even come to Dioxus at some point (aka Preact signals). But, in the world where we still care about providing <code>&amp;mut T</code> from <code>use_hook</code> , we need to find a new solution that doesn’t require rewriting your React apps to use signals.</p>
<p>Well, we’re working in Rust, we’ve got const, macros, custom PartialEq… let’s see if we can move some of this work to compile time.</p>
<p>To build a Dioxus app, you pretty much have to use the <code>rsx!</code> proc macro. We unfortunately don’t support a builder API or alternatives. There’s a lot of good reasons to do this: performance, forward compatibility, tooling, ergonomics, etc.</p>
<p>A block of <code>rsx!</code> might look like this:</p>
<pre><code class="lang-rust">rsx! {
    div {
        h1 {<span class="hljs-string">"Glorious Counter"</span>}
        p { <span class="hljs-string">"Count: {val}"</span> }
        button { onclick: <span class="hljs-built_in">move</span> |<span class="hljs-type">_</span>| <span class="hljs-type">val</span> += <span class="hljs-number">1</span>, <span class="hljs-string">"Increment"</span> }
        button { onclick: <span class="hljs-built_in">move</span> |<span class="hljs-type">_</span>| <span class="hljs-type">val</span> -= <span class="hljs-number">1</span>, <span class="hljs-string">"Decrement"</span> }
    }
}
</code></pre>
<p>If you look closely, you’ll notice that the entire tree is declared within the macro. There aren’t elements being created at runtime time, except for the dynamic text within the paragraph element. In React, you’d have to create every element from scratch, one-by-one, every time. But in Dioxus, we can do better.</p>
<p>The new technique Dioxus uses is to split each <code>rsx!</code> call into a static <code>Template</code> and a list of dynamic nodes. For the above <code>rsx!</code> call, this might look like</p>
<pre><code class="lang-rust">static THIS_TEMPLATE: Template = <span class="hljs-class">Template </span>{ <span class="hljs-comment">/* */</span> };

<span class="hljs-class">VNode </span>{
<span class="hljs-symbol">    template:</span> THIS_TEMPLATE,
<span class="hljs-symbol">    dynamic_nodes:</span> [
        Text(format_args!(<span class="hljs-string">"Count: {val}"</span>)
    ]
}
</code></pre>
<p>Now, on every render, we only create the single dynamic node. When we go to diff the VNode, we only need to diff that one text node too. So now, instead of 11 comparisons (9 elements and 2 attributes) we have one comparison. Diffing this template takes 90% less time than before! This is a huge win! Our app can be 10x bigger for the same diffing cost. And the results speak for themselves. Combined with the integration of <a href="https://crates.io/crates/sledgehammer">Sledgehammer</a>, Dioxus is pushing the limits of what the React model can reasonably achieve.</p>
<p><img src="https://i.imgur.com/9rbAXP9.png"></p>
<p>The React team also agrees that React can be better. That’s why they’ve started working on an experimental compiler for React.</p>
<p><a href="https://reactjs.org/blog/2022/06/15/react-labs-what-we-have-been-working-on-june-2022.html">https://reactjs.org/blog/2022/06/15/react-labs-what-we-have-been-working-on-june-2022.html</a></p>
<p>The plan here is to cache these elements and only update them when variables inside the <em>component</em> change. However, React-Forget still doesn’t fix the underlying issue of node creation, memory usage, or anything of the other things compile-time memoization achieves.</p>
<h2 id="taking-it-a-step-further">Taking it a step further</h2>

<p>Templates make diffing the tree faster, but they can also make building the UI faster too. Both SolidJS and LitHTML take advantage of this hack to achieve fantastic performance.</p>
<p>With support from the renderer, Dioxus can actually serialize these parsed RSX templates and let the renderer do all the caching.</p>
<p>Before, if we wanted to assemble a tree of nodes from an iterator, we’d have to do a ton of tedious work, creating each list item part by part.</p>
<pre><code class="lang-rust"><span class="hljs-comment">// This tree</span>
<span class="hljs-class">ul </span>{
    (<span class="hljs-number">0.</span>.len).map(|id| rsx!{
        <span class="hljs-class">li </span>{
            <span class="hljs-class">h3 </span>{ <span class="hljs-string">"user"</span> }
            <span class="hljs-class">div </span>{ <span class="hljs-string">"hello {id}"</span> }
        }
    })
}

<span class="hljs-comment">// item one...</span>
<span class="hljs-symbol">Edit:</span>:CreateElement(<span class="hljs-string">"li"</span>)
<span class="hljs-symbol">Edit:</span>:CreateElement(<span class="hljs-string">"h3"</span>)
<span class="hljs-symbol">Edit:</span>:CreateText(<span class="hljs-string">"user"</span>)
<span class="hljs-symbol">Edit:</span>:AppendChildren(<span class="hljs-number">1</span>)
<span class="hljs-symbol">Edit:</span>:CreateElement(<span class="hljs-string">"div"</span>)
<span class="hljs-symbol">Edit:</span>:CreateText(<span class="hljs-string">"hello 0"</span>, <span class="hljs-number">2</span>)
<span class="hljs-symbol">Edit:</span>:AppendChildren(<span class="hljs-number">1</span>)
<span class="hljs-symbol">Edit:</span>:AppendChildren(<span class="hljs-number">2</span>)

<span class="hljs-comment">// item two...</span>
<span class="hljs-symbol">Edit:</span>:CreateElement(<span class="hljs-string">"li"</span>)
<span class="hljs-symbol">Edit:</span>:CreateElement(<span class="hljs-string">"h3"</span>)
<span class="hljs-symbol">Edit:</span>:CreateText(<span class="hljs-string">"user"</span>)
<span class="hljs-symbol">Edit:</span>:AppendChildren(<span class="hljs-number">1</span>)
<span class="hljs-symbol">Edit:</span>:CreateElement(<span class="hljs-string">"div"</span>)
<span class="hljs-symbol">Edit:</span>:CreateText(<span class="hljs-string">"hello 0"</span>, <span class="hljs-number">2</span>)
<span class="hljs-symbol">Edit:</span>:AppendChildren(<span class="hljs-number">1</span>)
<span class="hljs-symbol">Edit:</span>:AppendChildren(<span class="hljs-number">2</span>)

<span class="hljs-comment">// and so on until we attach all the li to the ul</span>
<span class="hljs-symbol">Edit:</span>:AppendChildren(len)
</code></pre>
<p>With templates, we can serialize the tree and pass it to the renderer:</p>
<pre><code class="lang-rust">static TEMPLATE_HTML = "<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>user<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello _id_<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>";

Edit::SaveTemplate("demo.rs:5:1", TEMPLATE_HTML);
</code></pre>
<p>Now, whenever we create the list elements, it’s as simple as cloning some nodes that already exist and precisely modifying just a small part</p>
<pre><code class="lang-rust">Edit::LoadTemplate(<span class="hljs-string">"demo.rs:5:1"</span>);
Edit::HydateText(<span class="hljs-number">0</span>, <span class="hljs-string">"hello 0"</span>);
</code></pre>
<p>For the tiny case we’re showing here, the benefit might seem limited. However, for real-world apps with lots of elements, custom styles, and all sorts of extra metadata, this caching system is immensely powerful and extremely performant.</p>
<h2 id="what-does-this-enable-">What does this enable?</h2>

<p>Now that we’re working with the mindset of templates, we can start to build new functionality previously locked behind the old model.</p>
<h3 id="hot-reloading">Hot Reloading</h3>

<p>One amazing feature added to Dioxus using the new template model is hot reloading. You can now modify your running Dioxus app without recompiling, provided you add, remove, or modify elements inside of <code>rsx!</code> . This mechanism works for <em>any</em> renderer too, since each renderer has to implement the same protocol to manage edits.</p>
<p><video autoplay playsinline muted src="https://i.imgur.com/PSJdqKO.mp4"></video></p>
<p>Not only can templates be cached inside of a renderer, they can be modified after-the-fact. The renderer is smart enough to track down the instance of every template node on the page and apply the same patches.</p>
<h3 id="performant-liveview">Performant LiveView</h3>

<p>Another addition to Dioxus 0.3 is the new LiveView renderer. Much like its counterpart Phoenix LiveView, Dioxus LiveView enables entirely server-rendered apps and components while shipping minimal JS to the client. In the Liveview model, minimizing latency and bandwidth is crucial to keeping apps snappy, especially for lower-end clients.</p>
<p><img src="https://i.imgur.com/nJOX4cw.jpg" alt="Elixir LiveView"></p>
<p>Now, instead of sending hundreds or thousands of edits to the client to render things like lists and complex markup, Dioxus packages all the templates the client will use inside of the HTML shipped to the client. A sample HTML document that might be sent from the server to the client may look like this:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"demo.rs:123:456"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>user<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello _id_<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"main"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- pre-rendered page --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<p>Notice how the templates are collected during SSR and inserted into the header. The only edits sent over the network from the server to the client are commands to create/remove template nodes and to precisely modify just the nodes that changed. Fast, simple, and scalable!</p>
<h2 id="faster-server-side-rendering-ssr-">Faster Server-Side-Rendering (SSR)</h2>

<p>The other technique that SolidJS uses to achieve faster SSR performance is combining pre-rendered portions of templates together through string concatenation. Since the template is known at compile time, we can break it up into smaller chunks and just stitch them together during rendering. No need to build and traverse huge element trees!</p>
<pre><code class="lang-rust"><span class="hljs-comment">// Cached template segments:</span>

<span class="hljs-function"><span class="hljs-title">PreRendered</span><span class="hljs-params">(<span class="hljs-string">"&lt;div class=\"asdasdasd\" class=\"asdasdasd\""</span>.into()</span></span>,),
<span class="hljs-function"><span class="hljs-title">Attr</span><span class="hljs-params">(<span class="hljs-number">0</span>,)</span></span>,
<span class="hljs-function"><span class="hljs-title">PreRendered</span><span class="hljs-params">(<span class="hljs-string">"&gt;Hello world 1 --&gt;"</span>.into()</span></span>,),
<span class="hljs-function"><span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-number">0</span>,)</span></span>,
PreRendered(
    <span class="hljs-string">"&lt;-- Hello world 2&lt;div&gt;nest 1&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;nest 2&lt;/div&gt;"</span>.into(),
),
<span class="hljs-function"><span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-number">1</span>,)</span></span>,
<span class="hljs-function"><span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-number">2</span>,)</span></span>,
<span class="hljs-function"><span class="hljs-title">PreRendered</span><span class="hljs-params">(<span class="hljs-string">"&lt;/div&gt;"</span>.into()</span></span>,)
</code></pre>
<h2 id="disclaimer">Disclaimer</h2>

<p>Even with all the innovations here, it’s still very important to remember that Dioxus still takes after React. No matter how many tweaks, optimizations, and improvements we make to Dioxus, you can still shoot yourself in the foot with the classic React footguns.</p>
<p>These include</p>
<ul>
<li>Unkeyed lists</li>
<li>Poor use of memoization and comparisons</li>
<li>Misuse of use_effect</li>
<li>“God components” that do everything</li>
</ul>
<p>and a whole host of other issues that you might not find in frameworks like Solid and Sycamore.</p>
<p>That being said, since Dioxus relies on a VirtualDom, it can be used as the primary state system for any renderer. And we have a ton of options for renderers:</p>
<ul>
<li>Desktop (webview)</li>
<li>Mobile (webview)</li>
<li>Web</li>
<li>TUI</li>
<li>Skia</li>
<li>LiveView</li>
<li>Blitz (WGPU)</li>
<li>SSR + Hydration</li>
<li>Static site generation</li>
<li>VR/AR (coming soon!)</li>
</ul>
<p>Note that all this work is being done for Dioxus 0.3 and hasn’t yet been released as a major version. We’re still dogfooding these changes to make sure no new bugs have slipped through. If you want these changes released sooner rather than later, feel free to build something with <code>master</code> and let us know!</p>
<ul>
<li><a href="https://discord.gg/XgGxMSkvUM">Discord</a></li>
<li><a href="https://github.com/dioxuslabs/dioxus">Github</a></li>
<li><a href="https://www.reddit.com/r/rust/comments/zls556/making_dioxus_almost_as_fast_as_solidjs/">r/rust Post</a></li>
</ul>
</article><script>Prism.highlightAll()</script></section></div><footer class="sticky z-30 text-gray-400 bg-ghmetal body-font " data-node-hydration="62"><div class="container px-5 py-24 mx-auto flex md:items-center lg:items-start md:flex-row md:flex-nowrap flex-wrap flex-col"><div class="w-64 flex-shrink-0 md:mx-0 mx-auto text-center md:text-left"><a class="flex title-font font-medium items-center md:justify-start justify-center text-white" href="https://github.com/DioxusLabs/dioxus"><img src="https://avatars.githubusercontent.com/u/79236386?s=200&v=4" class="h-8 w-auto" alt="Dioxus Labs Icon"/><span class="ml-3 text-xl">Dioxus Labs</span></a><p class="mt-2 text-sm text-gray-500">An Open Source project dedicated to making Rust UI wonderful.</p></div><div class="flex-grow flex flex-wrap md:pl-20 -mb-10 md:mt-0 mt-10 md:text-left text-center"><div class="lg:w-1/4 md:w-1/2 w-full px-4" data-node-hydration="63"><h2 class="title-font font-medium text-white tracking-widest text-sm mb-3"><!--node-id64-->Community<!--#--></h2><nav class="list-none mb-10"><ul><li data-node-hydration="65"><a class="text-gray-400 hover:text-white" href="https://github.com/dioxuslabs" data-node-hydration="66"><!--node-id67-->Github<!--#--></a></li><li data-node-hydration="68"><a class="text-gray-400 hover:text-white" href="https://twitter.com/dioxuslabs" data-node-hydration="69"><!--node-id70-->Twitter<!--#--></a></li><li data-node-hydration="71"><a class="text-gray-400 hover:text-white" href="https://discord.gg/XgGxMSkvUM" data-node-hydration="72"><!--node-id73-->Discord<!--#--></a></li></ul></nav></div><div class="lg:w-1/4 md:w-1/2 w-full px-4" data-node-hydration="74"><h2 class="title-font font-medium text-white tracking-widest text-sm mb-3"><!--node-id75-->Learning<!--#--></h2><nav class="list-none mb-10"><ul><li data-node-hydration="76"><a class="text-gray-400 hover:text-white" href="https://docs.rs/dioxus" data-node-hydration="77"><!--node-id78-->docs.rs<!--#--></a></li><li data-node-hydration="79"><a class="text-gray-400 hover:text-white" href="/learn/0.5/guide" data-node-hydration="80"><!--node-id81-->Guide<!--#--></a></li><li data-node-hydration="82"><a class="text-gray-400 hover:text-white" href="/awesome" data-node-hydration="83"><!--node-id84-->Awesome<!--#--></a></li></ul></nav></div><div class="lg:w-1/4 md:w-1/2 w-full px-4" data-node-hydration="85"><h2 class="title-font font-medium text-white tracking-widest text-sm mb-3"><!--node-id86-->Projects<!--#--></h2><nav class="list-none mb-10"><ul><li data-node-hydration="87"><a class="text-gray-400 hover:text-white" href="https://github.com/DioxusLabs/dioxus" data-node-hydration="88"><!--node-id89-->Dioxus<!--#--></a></li><li data-node-hydration="90"><a class="text-gray-400 hover:text-white" href="https://github.com/DioxusLabs/dioxus/tree/main/packages/cli" data-node-hydration="91"><!--node-id92-->CLI<!--#--></a></li><li data-node-hydration="93"><a class="text-gray-400 hover:text-white" href="https://github.com/DioxusLabs/taffy" data-node-hydration="94"><!--node-id95-->Taffy<!--#--></a></li></ul></nav></div></div></div><div class="container mx-auto py-4 px-5 flex flex-wrap flex-col sm:flex-row"><p class="text-gray-400 text-sm text-center sm:text-left">© 2024 Dioxus Labs —<a class="text-gray-500 ml-1" rel="noopener noreferrer" href="https://twitter.com/dioxuslabs" target="_blank">@dioxuslabs</a></p></div></footer></div>
    <!-- Note the usage of `type=module` here as this is an ES6 module -->
    <script type="module">
      import init from "/./assets/dioxus/docsite.js";
      init("/./assets/dioxus/docsite_bg.wasm").then((wasm) => {
        if (wasm.__wbindgen_start == undefined) {
          wasm.main();
        }
      });
    </script>
    <script src="/./static/prism/prism.js"></script>
    <script src="/ace/ace.js"></script>
<script src="/ace/mode-rust.js"></script>
<script src="/ace/theme-github.js"></script>
<script src="/ace/theme-github_dark.js"></script>

  </body>
</html>
